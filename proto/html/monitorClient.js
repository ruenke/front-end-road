var $frontend_monitor=function(){function n(n,o){var r=i(),a=location.href,d=navigator.userAgent,c=document.cookie,s=1e9*Math.random()<<0,p=(new Date).getTime(),m=t(e([r.bw+""+r.bh,a,d,c,s,p,n].join("-"))).slice(20);return o?m:m+"-"+p.toString(16)}function o(){for(var n=document.cookie.split(/;\s?/),o={},e=0;e<n.length;e++){var t=n[e].split("=");try{o[t[0]]=decodeURIComponent(t[1])}catch(n){}}return o}function e(n){function o(n,o){return n<<o|n>>>32-o}var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof n){var i=unescape(encodeURIComponent(n));n=new Array(i.length);for(c=0;c<i.length;c++)n[c]=i.charCodeAt(c)}n.push(128);for(var r=n.length/4+2,a=Math.ceil(r/16),d=new Array(a),c=0;c<a;c++){d[c]=new Array(16);for(var s=0;s<16;s++)d[c][s]=n[64*c+4*s]<<24|n[64*c+4*s+1]<<16|n[64*c+4*s+2]<<8|n[64*c+4*s+3]}d[a-1][14]=8*(n.length-1)/Math.pow(2,32),d[a-1][14]=Math.floor(d[a-1][14]),d[a-1][15]=8*(n.length-1)&4294967295;for(c=0;c<a;c++){for(var p=new Array(80),m=0;m<16;m++)p[m]=d[c][m];for(m=16;m<80;m++)p[m]=o(p[m-3]^p[m-8]^p[m-14]^p[m-16],1);for(var w=t[0],f=t[1],g=t[2],u=t[3],_=t[4],m=0;m<80;m++){var h=Math.floor(m/20),l=o(w,5)+function(n,o,e,t){switch(n){case 0:return o&e^~o&t;case 1:return o^e^t;case 2:return o&e^o&t^e&t;case 3:return o^e^t}}(h,f,g,u)+_+e[h]+p[m]>>>0;_=u,u=g,g=o(f,30)>>>0,f=w,w=l}t[0]=t[0]+w>>>0,t[1]=t[1]+f>>>0,t[2]=t[2]+g>>>0,t[3]=t[3]+u>>>0,t[4]=t[4]+_>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,255&t[0],t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,255&t[1],t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,255&t[2],t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,255&t[3],t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,255&t[4]]}function t(n){for(var o="",e=0;e<n.length;e++){var t=n[e].toString(16);o+=t=1===t.length?"0"+t:t}return o}function i(){var n=window.innerWidth,o=window.innerHeight;return"number"!=typeof n&&("CSS1Compat"===document.compatMode?(n=document.documentElement.clientWidth,o=document.documentElement.clientHeight):(n=document.body.clientWidth,o=document.body.clientHeight)),{bw:n,bh:o}}function r(n){var e=window.$jd_page_monitor_config&&window.$jd_page_monitor_config.user_name,t=window.$jd_page_monitor_config&&window.$jd_page_monitor_config.user_id,r=window.$jd_page_monitor_config&&window.$jd_page_monitor_config.visit_level,a=i(),d=JSON.parse(JSON.stringify(n)),c=o().pin;return d.push(["pin",c]),d.push(["sv",S]),d.push(["time",(new Date).getTime()]),d.push(["page",h?"http://test.jd.com":location.href]),d.push(["screen_size",window.screen.width+"_"+window.screen.height]),d.push(["browser_size",a.bw+"_"+a.bh]),d.push(["user_id",t||"-1"]),d.push(["user_name",e||"-1"]),d.push(["visit_level",r||"-2"]),d.push(["tag",v]),d}function a(n){var o,e=[],t="";for(o=0;o<n.length;o++)e.push(n[o][0]+"="+encodeURIComponent(String(n[o][1]).replace(/\s+/g," ")));for(o=0;o<e.length;o++)t+=o?"&"+e[o]:e[o];return t}function d(n){var o=document.createElement("img");return o.width=1,o.height=1,o.src=n,o}function c(n){for(var o=0;o<n.length;o++)if(void 0===n[o])return!0;return!1}function s(n,o,e){n.addEventListener?n.addEventListener(o,e):n.attachEvent&&n.attachEvent("on"+o,e)}function p(n){return{bt:0,st:0,jt:0,wt:0,hxt:0,dns_t:-1,tt:-1,rt:-1,navigationStart:g,responseStart:u,responseEnd:_,page_load_type:n}}function m(n,o){return void 0===window.$jd_page_monitor_config.isLogBaseTime||"[object Function]"===Object.prototype.toString.call(window.$jd_page_monitor_config.isLogBaseTime)&&window.$jd_page_monitor_config.isLogBaseTime(n,o)}function w(){b=!0;for(var n=$.length,o=0;o<n;o++){for(var e=$[o],t=0;t<e.length;t++)try{e[t]()}catch(n){}$[o]=[]}}!window.$jd_page_monitor_config&&console.warn("没有配置window.$jd_page_monitor_config");var f=window.performance&&window.performance.timing,g=!(!f||!window.performance.timing.navigationStart),u=!(!f||!window.performance.timing.responseStart),_=!(!f||!window.performance.timing.responseEnd),h=window.$jd_page_monitor_config&&window.$jd_page_monitor_config.is_debug,l=(new Date).getTime(),v=window.$jd_page_monitor_config?window.$jd_page_monitor_config.user_name+"-"+window.$jd_page_monitor_config.user_id+"-"+l+"-":l+"-";v+=n("",!0);var j=h?"//test_pagemonitor.jd.com":"//pagemonitor.jd.com",S="3.0.16",y=0,$=[[function(){if(!window.$jd_page_monitor_config||!window.$jd_page_monitor_config.close_base_time){var n,o=f&&window.performance.timing.navigationStart||window.$jd_page_monitor_config&&window.$jd_page_monitor_config.firstStamp||jdpts._st||-1,e=(new Date).getTime(),t=f&&void 0!==window.performance.timing.domainLookupEnd&&void 0!==window.performance.timing.domainLookupStart,i=f&&void 0!==window.performance.timing.connectEnd&&void 0!==window.performance.timing.connectStart,r=f&&void 0!==window.performance.timing.responseStart&&void 0!==window.performance.timing.requestStart;n=-1===o?0:0!==y?y-o:f&&window.performance.timing.domContentLoadedEventStart?window.performance.timing.domContentLoadedEventStart-o:0,m(location.href,"open_page")&&$frontend_monitor.baseTime({bt:window.$jd_page_monitor_config&&window.$jd_page_monitor_config.header_finish_stamp&&-1!==o?window.$jd_page_monitor_config.header_finish_stamp-o:0,st:-1!==o?e-o:0,jt:n,wt:-1!==o&&f&&window.performance.timing.responseStart&&window.performance.timing.navigationStart?window.performance.timing.responseStart-window.performance.timing.navigationStart:0,hxt:_&&u?window.performance.timing.responseEnd-window.performance.timing.responseStart:0,dns_t:t?window.performance.timing.domainLookupEnd-window.performance.timing.domainLookupStart:-1,tt:i?window.performance.timing.connectEnd-window.performance.timing.connectStart:-1,rt:r?window.performance.timing.responseStart-window.performance.timing.requestStart:-1,navigationStart:g,responseStart:u,responseEnd:_,page_load_type:"open_page"})}}]],b=!1;s(window,"hashchange",function(){m(location.href,"hash_change")&&$frontend_monitor.baseTime(p("hash_change"))}),s(window,"popstate",function(){m(location.href,"history_pop")&&$frontend_monitor.baseTime(p("history_pop"))});var E=history.pushState;history.pushState=function(){E.apply(history,arguments),m(location.href,"history_push")&&$frontend_monitor.baseTime(p("history_push"))};var T=history.replaceState;history.replaceState=function(){T.apply(history,arguments),m(location.href,"history_replace")&&$frontend_monitor.baseTime(p("history_replace"))},window.$jd_page_monitor_config&&window.$jd_page_monitor_config.close_js_err||(window.onerror=function(n,o,e,t,i){if(i&&i.stack&&n){var r=i&&i.stack?i.stack.split("\n").slice(0,4).join("").replace(/\s+/g," "):n.replace(/\s+/g," "),a=!0;if(window.$jd_page_monitor_config&&window.$jd_page_monitor_config.isLogError)try{a=window.$jd_page_monitor_config.isLogError(r,o)}catch(n){}!1!==a&&$frontend_monitor.jsErr(r,o)}}),document.addEventListener&&document.addEventListener("DOMContentLoaded",function(){!y&&(y=(new Date).getTime())}),document.attachEvent&&document.attachEvent("onreadystatechange",function(){"interactive"===document.readyState&&!y&&(y=(new Date).getTime())}),document.readyState&&"complete"===document.readyState?w():s(window,"load",w);var x={business:function(n){if(c([n.postfix,n.detail]))console.warn("business 参数错误");else{var o=[];for(var e in n)""!==n[e]&&null!==n[e]&&void 0!==n[e]&&o.push([e,n[e]]);var t=r(o),i=d(j+"/business.jpg?"+a(t));i.onload=i.onerror=function(){i.onload=null,i.onerror=null}}},tp:function(n){if(c([n.postfix,n.spend_time]))console.warn("tp 参数错误");else{var o=[];n.remark=n.remark||"空";for(var e in n)""!==n[e]&&null!==n[e]&&void 0!==n[e]&&o.push([e,n[e]]);var t=r(o),i=d(j+"/tp.jpg?"+a(t));i.onload=i.onerror=function(){i.onload=null,i.onerror=null}}},baseTime:function(n){if(c([n.bt,n.st,n.jt,n.wt]))console.warn("baseTime 参数错误");else{var o=[];for(var e in n)n.hasOwnProperty&&n.hasOwnProperty(e),o.push([e,n[e]]);var t=r(o),i=d(j+"/baseTime.jpg?"+a(t));i.onload=i.onerror=function(){i.onload=null,i.onerror=null}}},ajaxErr:function(n){c([n.url,n.detail])?console.warn("ajaxErr 参数错误"):this.business({postfix:"ajaxErr",detail:n.detail,ajax_params:n.params,source:n.url,uuid:n.uuid})},jsErr:function(n,o){x.business({postfix:"jsErr",detail:n,source:o})},ajaxSpendTime:function(n){x.tp({postfix:"ajaxspendtime",spend_time:n.spend_time,ajax_href:n.ajax_href,ajax_params:n.ajax_params,uuid:n.uuid})},executeAfterLoad:function(n){var o,e=!1;return b||($.push([]),o=$.length-1,n>0&&setTimeout(function(){e=!0;for(var n=0;n<$[o].length;n++)try{$[o][n]()}catch(n){}$[o]=[]},n)),function(n,t){var i=void 0===t?t:JSON.parse(JSON.stringify(t));b||e?n(i):$[o].push(function(){n(i)})}},getUUID:n};return x}();